IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

1423

Quantization Index Modulation: A Class of Provably

Good Methods for Digital Watermarking and

Information Embedding

Brian Chen , Member, IEEE, and Gregory W. Wornell , Senior Member, IEEE

Abstract-We consider the problem of embedding one signal does. In some applications these degradations are the result of

(e.g., a digital watermark), within another "host" signal to form benign processing and transmission; in other cases they result

a third, "composite" signal. The embedding is designed to achieve from deliberate attacks.

efficient tradeoffs among the three conflicting goals of maximizing Several of these applications relate to copyright notification

information-embedding rate, minimizing distortion between the

host signal and composite signal, and maximizing the robustness

and enforcement for audio, video, and images that are dis-





of the embedding.


tributed in digital formats. In these cases, the embedded signal

We introduce new classes of embedding methods, termed quan-

either notifies a recipient of any copyright or licensing restric-

tization index modulation (QIM) and distortion-compensated

tions or inhibits or deters unauthorized copying. For example,

QIM (DC-QIM), and develop convenient realizations in the form

this embedded signal could be a digital "fingerprint" that

of what we refer to as dither modulation. Using deterministic

models to evaluate digital watermarking methods, we show that

uniquely identifies the original purchaser of the copyrighted

QIM is "provably good" against arbitrary bounded and fully

work. If illicit copies of the work were made, all copies would

informed attacks, which arise in several copyright applications, carry this fingerprint, thus identifying the owner of the copy

and in particular, it achieves provably better rate distortion-ro-from which all illicit copies were made. In another example,

bustness tradeoffs than currently popular spread-spectrum and

the embedded signal could either enable or disable copying

low-bit(s) modulation methods. Furthermore, we show that for

some important classes of probabilistic models, DC-QIM is op-

by some duplication device that checks the embedded signal

timal (capacity-achieving) and regular QIM is near-optimal. These before proceeding with duplication. Such a system has been

include both additive white Gaussian noise (AWGN) channels,

proposed for allowing a copy-once feature in digital video disc

which may be good models for hybrid transmission applications

recorders [2]. Alternatively, a standards-compliant player could such as digital audio broadcasting, and mean-square-error-con-check the watermark before deciding whether or not to play

strained attack channels that model private-key watermarking





applications.


the disc [3].

Other applications include automated monitoring of airplay

Index Terms-Data hiding, digital audio broadcasting, dither modulation, digital watermarking, hybrid transmission, in-of advertisements on commercial radio broadcasts. Advertisers

formation embedding, quantization index modulation (QIM),

can embed a digital watermark within their ads and count the





steganography.


number of times the watermark occurs during a given broad-

cast period, thus ensuring that their ads are played as often as

promised. In other applications, the embedded signal may be

used for authentication of-or detection of tampering with-the

host signal. For example, a digital signature could be embedded

I. INTRODUCTION

in a military map. A number of other national security appli-

ANUMBERofapplicationshaveemergedrecently[1]that cationsaredescribedin[4]andincludecovertcommunication, require the design of systems for embedding one signal,

sometimes called "steganography" or low probability of detec-

sometimes called an "embedded signal" or "watermark," within

tion communication, and so-called traitor tracing, a version of

another signal, called a "host signal." The embedding must be

the digital fingerprinting application described above used for

done such that the embedded signal is "hidden," i.e., causes no

tracing the source of leaked information.

serious degradation to its host. At the same time, the embedding

One final application for which the digital watermarking

must be robust to common degradations of the watermarked

methods developed in this paper are well-suited is the back-

signal-the watermark must survive whenever the host signal

ward-compatible upgrading of an existing communication

system, an example of which is the so-called hybrid in-band

Manuscript received June 14, 1999; revised September 20, 2000. This work on-channel digital audio broadcasting [5], [6]. In this appli-was supported in part by MIT Lincoln Laboratory Advanced Concepts Com-cation, one would like to simultaneously transmit a digital

mittee, the National Science Foundation under Grant CCR-0073520, Microsoft signal with existing analog (AM and/or FM) commercial

Research, and a National Defense Science and Engineering Graduate Fellow-ship.

broadcast radio without interfering with conventional analog

The authors are with the Department of Electrical Engineering and Computer reception. Thus, the analog signal is the host signal and the

Science, Massachusetts Institute of Technology (MIT), Cambridge, MA 02139

digital signal is the watermark. Since the embedding does

USA (e-mail: bchen@allegro.mit.edu; gww@allegro.mit.edu).

Communicated by T. E. Fuja, Associate Editor At Large.

not degrade the host signal too much, conventional analog

Publisher Item Identifier S 0018-9448(01)02834-6.

receivers can demodulate the analog host signal. In addition,

0018-9448/01$10.00 Â© 2001 IEEE





1424

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

next-generation digital receivers can decode the digital signal

embedded within the analog signal, which may be all or part

of a digital audio signal, an enhancement signal used to refine

the analog signal, or simply supplemental information such as

station identification or traffic information. More generally,

Fig. 1.

General information-embedding problem model. A message m is

the host signal in these hybrid transmission systems could be

embedded in the host-signal vector

using some embedding function ( ; m).

some other type of analog signal such as video [7], or even a A perturbation vector

corrupts the composite signal . The decoder extracts

an estimate ^

m of m from the noisy channel output .

digital waveform-for example, a digital pager signal could be

embedded within a digital cellular telephone signal.

In general, designers of information embedding systems for

tional attack models in Section VIII. Finally, Section IX con-

these kinds of applications seek to achieve high embedding rates

tains some concluding remarks.

with high levels of robustness and low levels of embedding-in-

duced distortion. However, in general, these three goals are con-

II. PROBLEM MODEL

flicting. Thus, in this paper we characterize methods in terms

Two mathematically equivalent models for the information-

of the efficiency with which they trade off rate, distortion, and

embedding problem are useful in our development.

robustness. For instance, for any minimum embedding rate re-

quirement and maximum acceptable level of embedding distor-

tion, the more efficient an embedding method is, the higher the

A. Distortion-Constrained Multiplexing Model

robustness that can be achieved.

The information-embedding problem is naturally and gener-

A great many information-embedding algorithms have been

ally described by Fig. 1. In this figure, there is a host-signal

proposed [1] in this still emerging field. Some of the earliest vector

into which we wish to embed some informa-

proposed methods [8], [9], [7] employ a quantize-and-replace tion

.1 We wish to embed at a rate of

bits per dimension

strategy: after first quantizing the host signal, these systems

(host-signal sample) so we can think of

as an integer in the

change the quantization value to embed information. A simple

set

.

example of such a system is the so-called low-bit(s) modulation

An embedding function maps the host signal and embedded

(LBM), where the least significant bit(s) in the quantization of

information

to a composite signal

subject to some

the host signal are replaced by a binary representation of the em-

distortion constraint. Various distortion measures may be of in-

bedded signal. More recently, additive spread-spectrum-based

terest, an example of which is the squared-error distortion

methods, which embed information by linearly combining the

host signal with a small pseudo-noise signal that is modulated

(1)

by the embedded signal, have received considerable attention in

the literature as an alternative to LBM-type methods [10]-[13].

or its expectation

. The composite signal

is

In this paper, we show that both LBM-type strategies and

subjected to various common signal processing manipulations

additive spread spectrum are, in general, not good choices for such as lossy compression, addition of random noise, and

most information embedding and digital watermarking appli-

resampling, as well as deliberate attempts to remove the

cations. As an alternative, this paper introduces a new class of

embedded information. These manipulations occur in some

information-embedding strategies we refer to as "quantization

channel, which produces an output signal

. For future

index modulation" (QIM) that is, in general, preferable and in

convenience, we define a perturbation vector to be the differ-

many specific scenarios optimal. We further develop computa-

ence

, as shown in Fig. 1; we consider cases of both

tionally efficient implementations of QIM in the form of what

signal-independent and signal-dependent perturbation vectors

we refer to as "dither modulation." We evaluate both specific re-

in this paper.

alizations of uncoded and coded QIM, and the asymptotic per-

A decoder extracts-i.e., forms an estimate

of-the em-

formance limits of coded QIM using information-theoretic anal-

bedded information

based on the channel output . We focus

ysis. Other emerging information-theoretic results on the digital

primarily on the "host-blind" case of interest in most applica-

watermarking problem are developed in, e.g., [14]-[20].

tions, where

is not available to the decoder, in contrast to the

The specific organization of the paper is as follows. In Sec-

"known-host" case, where the decoder can separately observe

tion II, we develop two useful equivalent models for the in-

. (See, e.g., [14] [17] for information-theoretic treatments of formation-embedding problem. In Section III, we classify tra-some aspects of the known-host case.) Our interest is in de-

ditional approaches to this problem, and in the process iden-

coders that produce reliable estimates whenever the channel is

tify some of their shortcomings. Section IV introduces the QIM

not too severe, where reliable means either that

deter-

class of embedding methods, and Section V develops practical

ministically or that

for sufficiently small . In

realizations that are compared to corresponding implementa-

tions of traditional approaches. Next, Section VI establishes

conditions under which different forms of QIM are optimal in

1The vector is any convenient representation of all or part of the host signal.

an information-theoretic sense. We then evaluate the methods of

In the case of a host image, it could be a vector of pixel values or discrete cosine transform (DCT) coefficients, for example. In the case of a host audio waveform, this paper in the context of Gaussian models for unintentional

this vector could be a vector of samples, spectral parameters, or linear prediction attacks in Section VII, and in the context of some general inten-coding (LPC) coefficients, for example.





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1425

such cases, the tolerable severity of the channel degradations is a measure of the robustness of an information-embedding system.

B. Equivalent Super-Channel Model

An alternative representation of the model of Fig. 1 is

shown in Fig. 2. The two models are equivalent since any

embedding function

can be written as the sum of the

host signal

and a host-dependent distortion signal

,

Fig. 2.

Equivalent super-channel model for information embedding. The

i.e.,

, simply by defining the distortion

composite signal is the sum of the host signal, which is the state of the super-channel, and a host-dependent distortion signal.

signal to be

. Thus, one can view

as the input to a super-channel that consists of the cascade

Host-interference nonrejecting methods have the general

of an adder and the true channel. The host signal

is a

property that the host signal is effectively a source of interfer-

state of this super-channel that is known at the encoder. The

ence in the system, and generally result from system designs

measure of distortion

between the composite and

that do not allow the encoder in Fig. 2 to sufficiently exploit

host signals maps onto a host-dependent measure of the size

knowledge of the host signal .

of the distortion signal . For example,

The simplest of such methods have purely additive embed-

squared-error distortion (1) equals the power of

ding functions of the form

(2)

Therefore, one can view information-embedding problems as

where

is typically a pseudo-noise sequence. Such em-

power-limited communication over a super-channel with a state

bedding methods are often referred to as additive spread-spec-

that is known at the encoder.2 As we will develop, this view will

trum methods, and some of the earliest examples are described

be convenient for determining achievable rate distortion-robust-

in [24], [25], [10], [26], [11], [12]. Typically,

takes the

ness tradeoffs of various information-embedding and -decoding

form

methods.

(3)

C. Channel Models

where

is a unit-energy spreading vector and

is a scalar

In general, the channel model is either a characterization of

function of the message.3

the degradations that can actually occur to the composite signal,

It is often convenient to view additive spread-spectrum as per-

or alternatively, a description of the class of degradations to

turbation of a projection. In particular, substituting (3) into (2) which the embedder and decoder must be robust, i.e., the system

and using that

has unit energy, we obtain

is designed to work against all degradations described by this

particular model. The latter viewpoint is particularly useful in

(4)

the context of intentional attacks.

We consider both probabilistic and deterministic channel

which when projected onto

we obtain

models. In the probabilistic case, we specify the channel

(5)

input-output relationship in terms of the conditional proba-

bility law

. Implicitly, this specification also describes the

where

is the corresponding projection of the host signal, i.e.,

conditional probability law of the perturbation vectors against

which the system must be robust since

(6)

Finally, substituting (5) back into (4) yields the composite signal reconstruction from projections

In the deterministic case, the channel input-output relationship

is described most generally in terms of the set of possible out-

(7)

puts

for every given input, or equivalently, in terms

of the set of desired tolerable perturbation vectors

for

From (2), we see that for this class of embedding methods,

every given input.

the host signal acts as additive interference that inhibits the de-

coder's ability to estimate

. Consequently, even in the absence

III. CLASSES OF EMBEDDING METHODS

of any channel perturbations

, one can usually embed

only a small amount of information. Thus, these methods are

An extremely large number of embedding methods have been

useful primarily when either the host signal is available at the

proposed in the literature [22], [23], [1]. Broadly, for our pur-decoder (as assumed in, e.g., [26]) or when the host-signal in-poses these can be divided into two classes: 1) host-interfer-

terference is much smaller than the channel interference.

ence nonrejecting methods and 2) host-interference rejecting

methods.

3Technically, spread-spectrum systems (2) for which (3) applies are classified as amplitude-modulation additive spread-spectrum methods, but since there is 2Cox et al. have also recognized that one may view watermarking as commu-no risk of confusion in this paper, we will use the term "additive spread-spec-nications with side information known at the encoder [21].

trum" to specifically mean those systems based on amplitude modulation.





1426

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

Information embedding systems can achieve host-interfer-

ence rejection when knowledge of the host signal at the en-

coder is adequately exploited in system design. Examples in-

clude LBM and, more generally, quantize-and-replace systems.

In LBM systems, the least significant bit(s) in the binary rep-

resentation of a host sample are simply replaced with message

bits. A class of quantize-and-replace systems that we refer to

as generalized LBM systems implement a vector generalization

of this embedding strategy. Generalized LBM embedding func-

tions are of the form

(8)

Fig. 3.

QIM for information embedding. The points marked with 2's and 's

where

represents the coarse quantizer that determines the

belong to two different quantizers, each with its associated index. The minimum most significant bits, and

is determined only by the (modu-

distance d

measures the robustness to perturbations, and the sizes of the

quantization cells, one of which is shown in the figure, determine the distortion.

lated) least significant bits. A defining characteristic of general-If m = 1, the host signal is quantized to the nearest 2. If m = 2, the host ized LBM systems is that the embedding never alters the most

signal is quantized to the nearest .

significant bits of the host signal, which is expressed in terms of the constraint

of any other function. For example, one might desire at the very

least that the ranges be nonintersecting. Otherwise, even in the

(9)

absence of any perturbations, there will be some values of from

Without loss of generality, we may assume that good general-

which one will not be able to uniquely determine

. In fact, it is

ized LBM quantizers are unbiased, i.e.,

precisely the nonintersection property that leads to host-signal

interference rejection.

(10)

The nonintersection property along with the approximate-

identity property (12), which suggests that the ranges of each

One example of a generalized LBM system is that developed

of the functions "cover" the space of possible (or at least highly

in [7], where LBM is effectively applied to a pseudorandom probable) host-signal values , suggests that the functions be

projection of the form (6). Thus, the embedding is of the form

discontinuous. Quantizers are just such a class of discontinuous,

(7) where

is now of the form

approximate-identity functions. Then, "QIM" refers to embed-

ding information by first modulating an index or sequence of

(11)

indices with the embedded information and then quantizing the

with

a uniform, scalar quantization function of step size

host signal with the associated quantizer or sequence of quan-

and

a perturbation value. It is convenient to think of this

tizers.

class of generalized LBM systems as "spread LBM" systems.

Fig. 3 illustrates this QIM information-embedding technique.

While generalized LBM systems are host-interference re-

In this example, one bit is to be embedded so that

.

jecting, they are unnecessarily constrained in a way that makes

Thus, we require two quantizers, and their corresponding sets

them generally inefficient and vulnerable to various classes of

of reconstruction points in

are represented in Fig. 3 with

attacks, which in turn limits the range of applications for which

's and

's. If

, the host signal is quantized with the

they can be used. Avoiding these constraints in the process of

-quantizer, i.e., is chosen to be the

closest to . If

,

developing optimal information-embedding systems naturally

is quantized with the

-quantizer.

gives rise to a new and general class of host-interference

As

varies, the composite signal value

varies from one

rejecting embedding methods called QIM, which we develop

point (

) to another or from one

point

to an-

in the sequel.

other, but it never varies between a

point and a

point. Thus,

even with an infinite energy host signal, one can determine

IV. Q

if channel perturbations are not too severe. The

points and

UANTIZATION INDEX MODULATION

points are both quantizer reconstruction points and signal con-

To develop the QIM concept, we begin by viewing the embed-

stellation points,4 and we may view design of QIM systems as

ding function

as an ensemble of functions of , indexed

the simultaneous design of an ensemble of source codes (quan-

by

. We denote the functions in this ensemble as

to

tizers) and channel codes (signal constellations).

emphasize this view. If the embedding-induced distortion is to

Conveniently, properties of the quantizer ensemble can be re-

be small, each function in the ensemble must be close to an iden-

lated directly to the performance parameters of rate, distortion,

tity function in some sense so that

and robustness. For example, the number of quantizers in the

ensemble determines the information-embedding rate

. The

(12)

sizes and shapes of the quantization cells determine the embed-

That the system needs to be robust to perturbations suggests

ding-induced distortion, all of which arises from quantization

that the points in the range of one function in the ensemble

4One set of points, rather than one individual point, exists for each value of should be far away in some sense from the points in the range

m.





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1427

error. Finally, for many classes of channels, the minimum dis-

where

is the Gaussian

-function

tance

(18)

(13)

between the sets of reconstruction points of different quantizers

A. Distortion-Compensated QIM

in the ensemble effectively determines the robustness of the em-

Distortion compensation is a type of postquantization pro-

bedding.5

cessing that can improve the achievable rate distortion-robust-

It is important to emphasize that, in contrast to the case where

ness tradeoffs of QIM methods. To see this, we begin by noting

the host signal is known at the receiver, the minimum-distance

that for a fixed rate and a given quantizer ensemble, scaling8 all

decoder needs to choose from all reconstruction points of the

quantizers by

increases

by a factor of

, thereby

quantizers, not just those corresponding to the actual host signal

increasing the robustness of the embedding. However, the em-

. In particular, the minimum-distance decoder makes decisions

bedding-induced distortion also increases by a factor of

.

according to the rule6

Adding back a fraction

of the quantization error to the

quantization value removes, or compensates for, this additional

(14)

distortion. The resulting embedding function is

If, which is often the case, the quantizers

map

to the

nearest reconstruction point, then (14) can be rewritten as

(19)

(15)

where

is the

th quantizer of an ensemble

whose reconstruction points have been scaled by

so that two

(While the minimum-distance decoder is especially convenient

reconstruction points separated by a distance

before scaling

to implement and analyze, a variety of other potentially useful

are separated by a distance

after scaling. The first term in

decoders are discussed in [27].)

(19) represents normal QIM embedding. We refer to the second

Intuitively, the minimum distance measures the size of pertur-

term as the distortion-compensation term.

bation vectors that can be tolerated by the system. For example,

The quantization error added back is a source of interfer-

if channel perturbations are bounded according to7

ence to the decoder. Typically, the probability density functions

(pdfs) of the quantization error for all quantizers in the QIM en-

(16)

semble are similar. Therefore, the distortion compensation term

in (19) is effectively statistically independent of

and can be

then the minimum-distance decoder is guaranteed to not make

treated as independent noise. Thus, decreasing

leads to greater

an error as long as

minimum distance, but for a fixed embedding-induced distor-

tion, the distortion-compensation interference at the decoder in-

(17)

creases. One optimality criterion for choosing

is to maximize

the following "SNR" at the decision device:

In the case of a classical additive white Gaussian noise (AWGN)

channel with a noise variance of

, at high signal-to-noise ratio

SNR

(SNR) the minimum distance also characterizes the error prob-

ability of the minimum-distance decoder [28],

where this SNR is defined as the ratio between the squared

minimum distance between quantizers and the total interfer-

ence energy from both distortion-compensation interference

and channel interference. Here,

is the minimum distance

when

and is a characteristic of the particular quantizer

5When the host signal is known at the decoder, as is the case in some appli-ensemble. One can easily verify that the optimal scaling

cations of interest, then the more natural minimum distance is

parameter

that maximizes this SNR is

d

(x) =

min ks(x; i) 0 s(x; j)k

DNR

or

(20)

DNR

d

= min min ks(x; i) 0 s(x; j)k:

where DNR is the (embedding-induced) distortion-to-noise

ratio

.

6Alternatively, if the host signal x is known at the decoder

As we will see, suitably coded versions of this distortion-

^

m( ; x) = arg min k 0 s(x; m)k:

compensated QIM with precisely the parameter setting (20) also

have important asymptotic optimality properties. Before devel-

oping these properties, let us first investigate some constraints

7We refer to this as the bounded perturbation channel and will revisit this deterministic channel in Section VIII-B1.

8If a reconstruction point is at q, it is "scaled" by by moving it to q=.





1428

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

that are useful to impose on QIM systems to facilitate imple-

This constraint ensures that the two corresponding

mentation.

-dimensional dithered quantizers are the maximum

possible distance from each other. For example, a

V. DITHER MODULATION: AN IMPLEMENTATION OF QIM

pseudorandom sequence of

and its negative

satisfy this constraint. One could alternatively choose

A key aspect of the design of QIM systems involves the

pseudorandomly with a uniform distribution over

choice of practical quantizer ensembles for such systems,

.10 Also, the two dither sequences need

which we now explore. In the process, we obtain additional

not be the same for each length-

block.

insights into the design, performance evaluation, and imple-

mentation of QIM embedding methods, particularly those of

iii) The th block of is quantized with the dithered quantizer

low complexity. A convenient structure to consider is that

using the dither sequence

.

of so-called dithered quantizers [29], [30], which have the A detailed assessment of the complexity of this QIM realiza-property that the quantization cells and reconstruction points

tion is developed in [15], [27].

of any given quantizer in the ensemble are shifted versions of

The minimum-distance properties of coded binary dither

the quantization cells and reconstruction points of any other

modulation are readily deduced. In particular, any two distinct

quantizer in the ensemble. In nonwatermarking contexts, the

coded bit sequences differ in at least

places, where

is

shifts typically correspond to pseudorandom vectors called

the minimum Hamming distance of the error-correction code.

dither vectors. For information-embedding purposes, the dither

For each of these

blocks, the reconstruction points of the

vector can be modulated with the embedded signal, i.e., each

corresponding quantizers are shifted relative to each other by

possible embedded signal maps uniquely onto a different dither

in the th dimension. Thus, the square of the minimum

vector

. The host signal is quantized with the resulting

distance (13) over all

dimensions is

dithered quantizer to form the composite signal. Specifically,

we start with some base quantizer

, and the embedding

function is

We call this type of information embedding "dither modula-

tion." We discuss several low-complexity realizations of such

(22)

dither-modulation methods in the sequel.

where to obtain the second equality we have used (21), and

A. Coded Binary Dither Modulation with Uniform Scalar

where, in the third line,

is the gain of the error-correction

Quantization

code

Coded binary dither modulation with uniform, scalar quanti-

zation is one such realization.9 We assume that

.

(23)

The dither vectors in a coded binary dither modulation system

are constructed as follows.

In the high signal-to-distortion ratio (SDR) regime of primary

interest for high-fidelity applications, the quantization cells are i) The

information bits

repre-

sufficiently small that the host signal can be modeled as uni-

senting the embedded message

are error-correction

formly distributed within each cell. In this case, the expected

coded using a rate-

code to obtain a coded bit se-

squared-error distortion of a uniform, scalar quantizer with step

quence

, where

size

is the familiar

(21)

(24)

(In the uncoded case,

and

.) We di-

Thus, the overall average expected distortion (1) is

vide the host signal

into

nonoverlapping blocks of

length

and embed the th coded bit

in the th block,

(25)

as described below.

ii) Two length-

dither sequences

and

and

one length-

sequence of uniform, scalar quantizers

Combining (22) and (25) yields the "distortion-normalized"

with step sizes

are constructed with the

squared minimum distance

constraint

(26)

10A uniform distribution for the dither sequence implies that the quantization error is statistically independent of the host signal and leads to fewer "false 9By scalar quantization, we mean that the high-dimensional base quantizer contours," both of which are generally desirable properties from a perceptual q(1) is the Cartesian product of scalar quantizers.

viewpoint [29].





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1429

Fig. 5.

Transform dither modulation with nonuniform quantization step sizes.

Fig. 4.

Dither modulation with uniform quantization step sizes.

a quantity that can be used to characterize the achievable perfor-

mance of QIM realizations more generally, as we will develop.

B. Spread-Transform Dither Modulation

One special class of coded binary dither modulation methods

is what we refer to as spread-transform dither modulation

(STDM). We now develop its properties and quantify its

advantages over other forms of dither modulation, over additive

spread-spectrum methods, and over spread LBM.

To introduce STDM, we begin by observing that the dis-

tortion-normalized squared minimum distance (26) of binary

dither modulation with uniform scalar quantization does not de-

pend on the sequence

, i.e., on the distribution of the dis-

tortion across samples within the length-

block. Thus, one is

free to choose any distribution without sacrificing

, so the

's can be chosen to optimize other characteristics of the em-

Fig. 6.

Transform dither modulation with quantization of only a single

bedding.

transform component. The quantization step size for the component of the host signal orthogonal to v is zero.

To understand this property, consider Figs. 4-6, each of which

show the reconstruction points of two quantizers for embedding

one bit in a block of two samples. For each of the three systems,

While the three systems corresponding to Figs. 4-6 have the

the minimum distance-

-and the average squared-error

same minimum distance, the number of perturbation vectors of distortion-

per sample-are identical. Thus, the robust-

minimum length that cause decoding errors is higher for the case

ness against bounded perturbations is the same in each case.

of Fig. 4 than for the case of Fig. 6. (For intermediate cases

However, the quantization differs in each case. In Fig. 4, where

such as the one shown in Fig. 5, where quantization step sizes

scalar quantization is applied to each sample separately, the

in different dimensions are different but nonzero, the number

quantization step sizes are the same for both samples. In Figs. 5

of perturbation vectors of minimum length that cause decoding

and 6, the samples are first pretransformed and the resulting co-

errors is the same as in Fig. 4, but these vectors are not orthog-

efficients quantized unevenly. In particular, a unitary transform

onal.) Thus, for probabilistic channels, such as additive noise

(coordinate rotation) is applied to the pair of samples before

channels, the probability of error is generally different in each quantization; the first transform coefficient is the component of

case. For example, suppose a

bit is embedded and the com-

the host signal in the direction of

depicted. In Fig. 5, the step

posite signal is the

point labeled with in Figs. 4 and 6. If the

size for quantizing the first transform coefficient is larger than

channel output lies in the decision region defined by the dashed

that used to quantize the second transform coefficient, which

box in Fig. 4 and defined by the two dashed lines in Fig. 6, then

lies in the direction orthogonal to . Finally, in the extreme case

the decoder will correctly determine that a

bit was embedded.

of Fig. 6, the step size for the first coefficient is larger still, and If the perturbation vector places the channel output outside the

that for the second coefficient is zero, i.e., all embedding occurs decision region, however, the decoder will make an error with

in the first coefficient. In this case, the reconstruction points be-very high probability. (There is some possibility that the channel

come reconstruction lines, so to embed a

bit, the host signal

output is outside the decision region but is still closer to a

is quantized to the nearest point on a line labeled with a

. To

point other than

than to the closest

. These events, however,

embed a

bit, the host signal is quantized to the nearest point

are very unlikely for many perturbation probability distributions

on a line labeled with a

.

that are of practical interest.) Since the decision region of Fig. 6





1430

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

contains the decision region of Fig. 4, it follows that the proba-

where

so that the expected distortion in both

bility of a correct decision in the case of nonuniform quantiza-

cases is the same, and where we have used the fact that

tion step sizes is higher.

and

are chosen such that

.

The unitary transform in the case of Fig. 6 not only facilitates

The decoder in both cases makes a decision based on , the

a comparison of Figs. 4 and 6, but also serves to spread any em-

projection of the channel output

onto . In the case of additive

bedding-induced distortion over frequency and time/space when

spread spectrum,

, while in the case of STDM,

a peak distortion constraint is imposed, for example. Although

, where

is the projection of the perturbation

the distortion is concentrated in only one transform coefficient,

vector

onto

. We let

be some measure of energy. For

if the energy of

is spread over space/time and frequency-for

example,

in the case of a deterministic variable , or

example, if

is chosen pseudorandomly-then the distortion

when

is random. The energy of the interference

will also be spread.

or "noise" is

for additive spread spectrum, but only

As we will see in subsequent sections of this paper, dither-

for STDM, i.e., the host-signal interference for STDM is

modulation methods have considerable performance advantages

zero. Thus, the SNR at the decision device is

over previously proposed additive spread-spectrum and spread

LBM methods in a variety of contexts. However, much effort has

SNR

already been invested in optimizing both additive spread-spec-

trum and spread LBM systems, for example, by exploiting per-

for additive spread spectrum and

ceptual properties of the human visual and auditory systems or

designing receiver front-ends to mitigate effects of geometric

SNR

and other distortions. An additional advantage of STDM specifi-

cally over other forms of dither modulation is that one can easily

for STDM, where the "signal" energies

convert existing additive spread-spectrum and spread LBM sys-

tems into STDM systems while retaining the other optimized

components of the system. In particular, it suffices to replace the and

addition step of additive spread spectrum, i.e., (5), or the quan-

tize-and-replace step of spread LBM, i.e., (11), with the dithered

are given by (28) and (29). Thus, the advantage of STDM over

quantization step of STDM, i.e.,

additive spread spectrum is

SNR

(27)

(30)

SNR

SNR Advantage of STDM: In this section, we quantify the

which is typically very large since the channel perturbations

performance gain of STDM over additive spread spectrum and

are usually much smaller than the host signal

if the channel

spread LBM from an SNR perspective that applies to a broad

output

is to be of reasonable quality. For example, if the host-

range of contexts. We focus our analysis on the representative

signal-to-channel-noise ratio is 30 dB and

and

are uncor-

case of embedding one bit in a length-

block

using a unit-

related, then the SNR advantage (30) of STDM over additive

length spreading vector

. Because, as (5), (11), and (27) re-

spread spectrum is 28.8 dB.11

flect, in each case the embedding occurs entirely in the projec-

SNR advantage of STDM over spread LBM: Spread-trans-

tion of onto , a one-dimensional problem results. In addition,

form dither modulation methods also have an SNR advantage

because all of the embedding-induced distortion occurs only in

over spread LBM methods. As we show in Appendix A, the

the direction of , the distortion in each case also has the same

distortion-normalized squared minimum distance (26) of LBM

temporal/spatial distribution and frequency distribution. Thus,

is

2.43 dB worse than that of dither modulation in the

one would expect that any perceptual effects due to time/space

case of coded binary embedding with uniform, scalar quantiza-

masking or frequency masking are the same in each case. There-

tion. Thus, for a fixed rate and embedding-induced distortion,

fore, squared-error distortion and SNR-type measures are more

the squared-minimum distance, and hence the SNR at the deci-

meaningful measures of distortion when comparing these em-

sion device, for spread LBM will be 2.43 dB worse than that of

bedding methods than one might expect in other more general

STDM, i.e.,12

contexts where squared-error distortion may fail to capture cer-

SNR

tain perceptual effects.

2.43 dB

(31)

SNR

SNR avantage of STDM over additive spread spec-

trum: Considering the case of additive spread-spectrum first, This SNR advantage is illustrated in Fig. 7, where the quantizer

since

in (5), we have

reconstruction points and embedding intervals for both spread

11Note that while the high SDR approximation (30) predicts that STDM is (28)

worse than additive spread spectrum by a factor of 4=3 = 1.25 dB when ~

x 0

(as would be the case, for example, if the host signal

had very little energy in

the direction of v), in fact, if one chooses d(m) = 61=4 then it is straightfor-For STDM (27)

ward to verify that STDM performs as well as additive spread spectrum in this low SDR regime.

12

(29)

Appendix A also shows that for M -ary embedding the SNR gain grows to 2 (3 dB) as M ! 1.





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1431

and a memoryless channel with known pdf

where

and

are the th components of

and , respectively.13

Then, the super-channel is also memoryless and has probability

law

Fig. 7.

Spread-transform dither modulation versus spread LBM. The

embedding interval boundaries of spread LBM, which are shown with solid The capacity [31] of this super-channel is the reliable informa-lines, are the same for both 2 points and points. In contrast, in the case of

tion-embedding rate

that is asymptotically achievable with

STDM, the 2-point embedding intervals, shown by solid lines, differ from the

-point embedding intervals, shown by dashed lines. An SNR advantage of long signal lengths

.

7=4 = 2.43 dB for STDM results.

In nonwatermarking contexts, Gel'fand and Pinsker [32] and Heegard and El Gamal [33] have determined the capacity of such a channel in the case of a random state vector

with inde-

LBM and STDM are shown, with the same embedding-induced

pendent and identically distributed (i.i.d.) components when the

squared-error distortion for both cases.

encoder sees the entire state vector before choosing the channel

The preceding analysis establishes some important advan-

input . In this case, the capacity is

tages of QIM methods over common information-embedding

methods. In fact, it turns out that QIM methods are asymptoti-

(32)

cally optimal in many key scenarios of interest. To develop these

results, we next examine information embedding within an in-

formation-theoretic framework.

where

denotes mutual information and

is an auxiliary

random variable. Since

we can think of

in (32) as being generated from , and, in turn,

from

and .

VI. INFORMATION-THEORETIC OPTIMALITY OF QIM

While the mapping from

to

is, in general, probabilistic, from

This section explores the best possible rate-distortion-robust-

convexity properties of mutual information, one can deduce that

ness performance that one could hope to achieve with any infor-

the maximizing distribution in (32) always has the property that

mation-embedding system. Our analysis leads to insights about

is a deterministic function of

[32].

some properties and characteristics of good information-em-

In the case of watermarking, the maximization (32) is subject

bedding methods, i.e., methods that achieve performance close

to a distortion constraint

. A formal proof of the ex-

to the information-theoretic limits. In particular, a canonical

tension of (32) to include this constraint is developed in [20].

"hidden QIM" structure emerges for information embedding

Other researchers [18], [19], [16] are working on extending or that consists of 1) preprocessing of the host signal, 2) QIM em-have extended these results to the case where the channel law

bedding, and 3) postprocessing of the quantized host signal to

is not fixed but rather is chosen by an attacker subject to a

form the composite signal. One incurs no loss of optimality

distortion constraint. A related information-theoretic formula-

by restricting one's attention to this simple structure. We also

tion can be found in [14].

derive sufficient conditions under which only distortion com-

As we shall see in the next section, one way to interpret (32)

pensation postprocessing is required. As we develop in Sec-

is that

is the total number of bits per host-signal sample

tions VII and VIII, these conditions are satisfied in several im-

that can be transmitted through the channel, and

is the

portant cases of practical interest.

number of bits per sample that are allocated to the host signal .

The difference between the two is the number of bits per host-

A. Communication over Channels with Side Information

signal sample that can be allocated to the embedded information

The super-channel model of Section II-B and Fig. 2 facilitates

.

our analysis, i.e., we view information embedding as the trans-

1) Hidden QIM: As we show in this subsection, one can

mission of a host-dependent distortion signal

over a super-

achieve the capacity (32) by a type of "hidden" QIM, i.e., QIM

channel with side information or state

that is known at the en-

that occurs in a domain represented by the auxiliary random

coder. In this section, we also restrict our attention to a squared-variable

. One moves into and out of this domain with pre-

error distortion constraint

and postquantization processing.

13Extension of results in this section to the case where the channel is only block-wise memoryless is straightforward by letting y and s be the ith blocks, rather than ith scalar components, of y and s. In this case, information rates are measured in bits per block, rather than bits per sample.





1432

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

is close to .15 Thus, the probability of error

is

small, and we can indeed achieve the capacity (32) with QIM in

the

-domain.

The remaining challenge, therefore, is to determine the right

pre-processing and postprocessing given a particular channel

(attack)

. As mentioned above, for a number of important

cases, it turns out that the only processing required is postquan-

tization distortion compensation. We discuss these cases in the

next subsection.

2) Optimality

of

Distortion-Compensated

QIM: When

distortion-compensated QIM (DC-QIM) as introduced in Sec-

tion IV-A is viewed as an instance of hidden QIM, we obtain

that

is a quantized version of

. We show in this section

that suitably coded versions DC-QIM can achieve capacity

whenever the maximizing distribution

in (32) is of a

form such that the postprocessing is linear, i.e., when, without

Fig. 8.

Capacity-achieving "hidden QIM." One embeds by choosing a

loss of generality,

is generated according to

codeword u that is jointly distortion-typical with

from the mth quantizer's

codebook. The distortion function is e (u; x). The decoder finds a codeword (33)

that is jointly typical with . If this codeword is in the ith subset, then ^

m = i.

To see that DC-QIM can achieve capacity when the maxi-

To develop this optimality of hidden QIM, we begin by

mizing pdf in (32) satisfies (33), we show that one can construct

adding an interpretation in terms of quantization (source

an ensemble of random DC-QIM codebooks that satisfy (33).

coding) to the proof of the achievability of capacity by Gel'fand

First, we observe that quantizing

is equivalent to quantizing

and Pinsker [32], the result of which is summarized as fol-with a scaled version of the quantizer and scaling back the

lows. Fig. 8 shows an ensemble of

quantizers, where

result, i.e.,

, where each source codeword

(quantizer reconstruction vector)

is randomly drawn from

(34)

the i.i.d. distribution

, which is the marginal distribution

corresponding to the host-signal distribution

and the max-

where

is as defined following (19). Then, rearranging

imizing conditional distribution

from (32). Although

terms in the DC-QIM embedding function (19) and substituting

the source codebooks are, therefore, random, both the encoder

(34) into the result, we obtain

and decoder, of course, know the codebooks. Each codebook

contains

codewords so there are

codewords total.

QIM embedding in this

-domain corresponds to finding a

(35)

vector

in the

th quantizer's codebook that is jointly distor-

tion-typical with

and generating

We construct our random DC-QIM codebooks by choosing

the codewords of

from the i.i.d. distribution

,

the one implied by the maximizing pdf in (32) together with

the host pdf

. (Equivalently, we choose the codewords of

By distortion-typical, we mean that

and

are jointly typical

in (19) from the distribution of

.) Our quan-

and

, i.e., the function

is the

tizers

choose a codeword

that is jointly distor-

distortion function in the

-domain. Since the

th quantizer's

tion-typical with

. The decoder looks for a codeword in all

codebook contains more than

codewords, the proba-

of the codebooks that is jointly typical with the channel output.

bility that there is no

that is jointly distortion-typical with

Then, following the achievability argument of Section VI-A1,

is small.14 Thus, the selection of a codeword from the

th

we can achieve a rate

. From (35), we see that

quantizer is the quantization part of QIM, and the generation of

, and, therefore,

, from the codeword

and

is the

postquantization processing.

Since

, we see that

. Thus, if

The decoder finds a

that is jointly typical with the channel

the maximizing distribution in (32) satisfies (33), our DC-QIM

output

and declares

if this

is in the th quantizer's

codebooks can also have this distribution and, hence, achieve

codebook. Because the total number of codewords,

is less than

capacity (32).

, the probability that a

other than

is jointly typical

As a final comment, it is worth emphasizing that QIM sys-

with is small. Also, the probability that is jointly typical with

tems are optimal in other important scenarios as well. As one ex-

ample, in the noise-free case

, which arises, for example,

14This principle is, of course, one of the main ideas behind the rate-distortion 15These principles are, of course, two of the main ideas behind the classical theorem [31, Ch. 13].

channel coding theorem [31, Ch. 8].





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1433

when a discrete-valued composite signal is transmitted over a

Remarkably, the capacity is independent of the signal variance

digital channel with no errors, QIM is optimal even without dis-

and, in fact, as we shall discuss later in this section, is the

tortion compensation, and achieves capacity [27]

same as in the case when the host signal

is known at the

decoder. Note that this implies that an infinite energy host

(36)

signal causes no decrease in capacity in this Gaussian case, i.e.,

good information-embedding systems can completely reject

As a second example, and as shown in [27], QIM is optimal host-signal interference in the Gaussian case.

even when the host signal is also available at the decoder

Based on our earlier results, to establish the optimality of

achieving the capacity

DC-QIM for this channel, it suffices to verify that (33) is sat-

isfied. This follows from the proof [34] of (38). In particular, as (37)

shown in [34], the pdf that maximizes (32) is indeed one implied by (33), for some parameter

, where

is chosen as a

determined by Heegard and El Gamal [33].

function of

so that

and so that the pair

and

We next examine some key scenarios when the optimality

are independent. To see this, note that for a fixed value of , an

condition (33) is met.

achievable rate

is [34]

VII. GAUSSIAN CHANNELS

In this section, we examine the ultimate performance limits

of information-embedding methods when both the host signal is

which can also be written in terms of the DNR and the host SNR

white and Gaussian, the channel is an AWGN channel, and the

(SNR

)

host and channel noise are independent of one another. Exten-

sions to colored host and/or colored channel cases are developed

DNR

DNR SNR

in [15], [27]. Our main result of the section is that DC-QIM

DNR SNR

DNR

SNR

is optimal for this class of channels, and that, in addition, the

(39)

optimum distortion-compensation parameter

is also given by

(20), which maximized SNR in uncoded DC-QIM systems.

This rate is maximized by setting (cf. (20))

In general, the embedding strategies optimized for Gaussian

DNR

channel models can be expected to be good designs for a va-

(40)

DNR

riety of applications in which one primarily requires robustness

against unintentional attacks.16 And while Gaussian host models

from which we conclude that the rate (38) is achievable. To es-

are not always accurate, the better the host-signal interference

tablish that (38) is also the maximum achievable rate, it suffices

rejection properties of an information-embedding system, the

to show that it is the capacity when

is known at the decoder,

smaller the role we might expect the host-signal model to play

since one obviously cannot do better in the host-blind case.

in determining the ultimate performance of such systems.

To develop the known-host capacity, first recall that the

capacity is given by (37). Again, the maximization is subject

A. Capacities and the Optimality of DC-QIM

to a distortion constraint, which in the case of white noise is

Specializing the formulation of Section VI-A to the Gaussian

. Because subtracting a known constant from

scenario of interest, with the zero-mean, variance-

variables

does not change mutual information, we can equivalently write

denoting elements of the

-dimensional host-signal vector

, and, similarly, the zero-mean, variance-

variables

de-

noting elements of the corresponding noise vector , the distor-

tion constraint can be expressed as

Noting that

, we immediately conclude that

in the case of an AWGN channel the known-host capacity is

indeed given by (38), where the maximizing distribution

is

a zero-mean Gaussian distribution with variance

.

In the known-host case, additive spread spectrum is optimal,

with the corresponding constraint on

in (32) being

and optimal additive spread-spectrum systems superimpose

. We see that squared-error distortion-constrained,

zero-mean i.i.d. Gaussian sequences with variance

onto the

Gaussian information embedding is equivalent to power-con-

host signal. However, it is important to note that QIM is also

strained communication over a Gaussian channel with Gaussian

optimal in this case as well-as discussed in [15], quantizers side information known at the encoder, a case for which Costa

of optimal QIM systems have reconstruction sequences

[34] has determined the capacity to be, expressed in terms of chosen i.i.d. from a zero-mean Gaussian distribution with

the (embedding induced) DNR

variance

. Hence, yet another attractive property of

QIM methods is that they are optimal in more general Gaussian

DNR

DNR

(38)

broadcast scenarios, where some intended recipients of the

embedded information know the host signal and some do not.

16Indeed, these models can even apply to optimal, i.e., rate-distortion As a final comment, several of the methods we have dis-achieving [31], lossy compression of a Gaussian source, as discussed in [27].

cussed can be optimal in the small host-signal interference sce-





1434

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

nario

. In fact, the capacity (38) is rather immediate

Thus, the available embedded digital rate in bits per second

in this scenario: Fig. 2 reduces to the classical communication

depends only on the bandwidth of the host signal and the toler-

problem considered in, e.g., [31],

, so that the capacity is

able degradation in received host-signal quality, and is approx-

the usual mutual information between

and

maximized

imately 1/3 b/s for every hertz of bandwidth and every decibel

over all

such that

. In the AWGN channel

drop in received host SNR. It is worth noting that, as developed

case, specifically, (38) results. Examining (39) in the associated

in [15], [27], these results carry over to the case of colored host regime SNR

, we see that distortion-compensated QIM

and/or colored channel cases as well.

with any

, including

(regular QIM), is optimal in this

Additional insights into the performance limits of such sys-

small host interference scenario. As one might expect, additive

tems when the digital signal is specifically information for re-

spread-spectrum systems can be capacity-achieving in this limit

fining the analog signal, as arises in applications involving the

as well, which we will see more explicitly in Section VII-C4.

upgrading of analog infrastructure, are developed in [20].

2) Coded Digital Host Signals: When the host signal is a

B. Capacities for Hybrid Transmission

coded digital signal, an alternative measure of the received host-

In this section, we consider scenarios corresponding to

signal quality is the capacity of the corresponding host digital

applications in which information embedding is part of a

channel. For example, in the case of white noise and a white host

hybrid transmission scheme. We investigate two classes of

signal,17 if there were no embedding, the capacity corresponding

such schemes: analog-digital and digital-digital transmission.

to a host digital signal power of

and a noise variance of

In the former class, the host is an analog signal, as arises in,

would be

for example, the digital audio broadcasting application. In the

latter class, the host signal is itself a digital signal, which has SNR

implications for broadcast transmission and related applications

Embedding an additional digital signal within the host digital

[31, Ch. 14].

signal drops the host digital capacity to

In both cases, one is generally most concerned with the

quality of the received signals, i.e., the channel output, rather SNR

than the channel input (composite signal).

DNR

1) Analog Host Signals: In this subsection, we determine

due to the drop in received host SNR of

DNR. Unlike in the

how reliable embedding at a given rate impacts the quality with

case of an analog host signal, if one must actually lower the rate

which an analog host signal is received and can be decoded with

of the coded host digital signal as a result of the embedding, then its conventional receiver from a noisy channel.

one may have to redesign both the digital encoder that generates

In general, the effect of the embedding is to create an addi-

this coded digital host signal and the corresponding decoder.

tional noise source DNR times as strong as the channel noise,

Thus, depending on the designed noise margin of the original

and, therefore, the received signal quality drops by a factor of

digital host signal, backward compatibility may or may not be

DNR or

possible.

However, even when digital-digital transmission cannot be

DNR dB

(41)

backward-compatible, using information embedding for simul-

For example, in the scenario analyzed in Section VII-A, op-

taneous transmission of two digital signals is potentially attrac-

timum DC-QIM results in an embedding-induced distortion that

tive from the point of view of complexity and privacy. In partic-

looks like white noise with variance

. With no embedding,

ular, the decoder for the host signal need not decode (nor know

one would have had a received host SNR of SNR

.

how to decode) the embedded signal, and vice versa.

Due to the additional interference from the embedding-induced

As discussed further in [27], this is qualitatively different be-distortion, however, the received host SNR drops to

havior from the superposition coding and successive cancella-

tion decoding one might otherwise use for simultaneous trans-

SNR

mission of two digital signals, where one of the receivers needs

DNR

to decode both messages to receive its own.

a drop of

DNR.

Interestingly, the information-embedding approach is equally

Since the capacity in bits per dimension (bits per host-signal

efficient. To see this, we note that the embedded digital channel

sample) is given by (38), and there are two independent host-

rate is given by (38)

signal samples per second for every hertz of host-signal band-

width [28], the capacity in bits per second per hertz (b/s/Hz) is DNR

DNR b/s/Hz

(42)

so that the combined rate of the two channels is

Taking the ratio between (41) and (42), we see that the "value"

DNR

SNR

in embedded rate of each decibel drop in received host-signal

Since the associated expended power is

, we conclude

quality is

that this digital-over-digital transmission strategy is indeed ef-

DNR

0.3322 b/s/Hz/dB

17As is well known [31], white Gaussian coded signals are capacity-achieving DNR

for transmission over AWGN channels, so this is a good model for the host signal (43)

in this case.





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1435

ficient: the combined rate

is as large as the achievable

of spread-transform QIM by appropriately modifying

rate using a single digital signal with this same total power.

(44) to obtain

DNR SNR

C. Gaps to Capacity

DNR

DNR SNR

In Section VII-A, we saw that DC-QIM is a capacity-

achieving strategy. In this section, for comparison, we eval-

DNR

(45)

uate the degree to which specific strategies such as regular

QIM (i.e., without distortion compensation), coded additive

To upper-bound the gap between QIM and capacity we first

spread-spectrum, uncoded STDM, and uncoded generalized

recognize from (45) that the minimum DNR required for QIM

LBM can each approach capacity-and hence the performance

to achieve a rate

asymptotically with large

is

of DC-QIM-when suitably optimized. We quantify the perfor-

mance of these systems in terms of the additional DNR required

DNR

(46)

to achieve the same rate as a capacity-achieving system.

1) Regular QIM Gap to Capacity: As we now show, the per-

which is minimized at

.19 However,

formance of the best QIM methods without distortion compen-

even in the limit of large

to have

. Thus, if one

sation can approach the Gaussian capacity at high rates and is

sets

within 4.3 dB of capacity at low rates, indicating that the QIM

class is large enough to include very good embedding functions

(47)

and decoders.

To develop a lower bound on the achievable rate of QIM

then (46) remains a valid upper bound on the required DNR

without distortion compensation, we begin by specializing (39)

for a QIM method to achieve a rate

. From (38) we see that

to the case

, resulting in

the minimum DNR required for a capacity-achieving method to

achieve a rate

is

, which when combined

DNR

SNR

DNR

(44)

with (46) yields the following upper bound between QIM and

DNR

SNR

the Gaussian capacity:

where to achieve this bound we choose reconstruction points

DNR

(48)

from the pdf implied by (33).18 The right-hand side of (44) is

DNR

generally not the capacity of QIM, however-i.e., QIM systems

can achieve a rate greater than the lower bound (44). Indeed, the

This expression is plotted in Fig. 9, where

is given by (47).

right-hand side of (44) actually approaches

in the limit of

We now examine the asymptotic limits of (48) at low and high

low DNR.

rates. Equation (47) implies

in the limit

A tighter lower bound is obtained by developing a dif-

of small

, so in this limit (48) approaches

ferent lower bound on the capacity of a particular subclass

DNR

of QIM methods we refer to as "spread-transform QIM."

DNR

In spread-transform QIM, which is a generalization of

STDM as developed in Section V-B, the host-signal vector

is projected onto

orthonormal vec-

tors

to obtain transformed host-signal

samples

which are quantized using QIM.

as

Because projection onto the vectors

represents a change of

orthonormal basis, the transformed host-signal samples and

Thus, the gap is at most a factor of

(approximately 4.3 dB)

the transformed noise samples

, which are the

in the limit of low rates. In the limit of large

, (47) implies

projections of the original noise vector

onto

so (48) approaches

the orthonormal vectors

, are still independent, zero-mean,

DNR

Gaussian random variables with the same variance as the

as

DNR

original host signal and noise samples, respectively. However,

if the distortion per original host-signal sample is

, then the

Thus, QIM asymptotically achieves capacity at high embedding

distortion per transformed host-signal sample is

. Thus,

rates.

we obtain a "spreading gain" of

in terms of DNR, but the

As we described in Section VII-B, in hybrid transmission ap-

number of bits embedded per original host-signal sample is

plications one may be concerned about the degradation to the

only

times the number of bits embedded per transformed

received host signal, which is

DNR rather than DNR. The

host-signal sample. Thus, one can determine an achievable rate

19Note that since

N

N

N





+ 0:5

round

0 0:5

18The pdf of the reconstruction points u = s in this case is N (0; D + ), which is not the same as the well-known rate-distortion optimal pdf [31] for one can, indeed, approach this optimum spreading gain L

in the limit of large

quantizing Gaussian random variables, which is N (0; 0 D ).

N even though N=L

need be a positive integer less than or equal to N .





1436

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

Fig. 9.

DNR gap between spread-transform QIM and Gaussian capacity

Fig. 10.

Received host SNR gap (1 + DNR) between spread-transform QIM

(achieved by DC-QIM). The maximum gap is a factor of e ( 4.3 dB).

and capacity (achieved by DC-QIM).

gap in DNR (48) is larger than the gap in

DNR , which has

a corresponding upper bound

DNR

DNR

This gap is plotted in Fig. 10 as a function of

, the rate in

b/s/Hz. Again,

is given by (47) since minimizing DNR

also minimizes

DNR

. Thus, for example, at the (near)

worst case digital rate of 1 b/s/Hz using QIM requires at most 1.6

dB more drop in analog channel quality than the approximately

3-dB drop required for DC-QIM (Section VII-B1).

2) Uncoded STDM Gap to Capacity: The results above can

be compared to the achievable performance of uncoded binary

STDM with uniform scalar quantization as a minimal-com-

plexity realization of QIM.

Fig. 11.

Uncoded STDM gap to Gaussian capacity. The solid curve shows

The gap between uncoded STDM and capacity can easily

the bit-error probability for uncoded STDM as a function of rate-normalized be quantified for low rates

, which are typical in

distortion-to-noise ratio (DNR

). The dashed curve is the minimum required

DNR

for reliable information embedding for any embedding method.

many applications, at a given probability of error. A straightfor-

ward union bound on the bit-error probability of uncoded binary

STDM with uniform scalar quantization is (see Fig. 6)

For low embedding rates

,

so the

minimum required DNR

for arbitrarily low probability of

error is

DNR

1.4 dB

(50)

This bound is reasonably tight for low error probabili-

The probability of error

of STDM is plotted as a function of

ties, and from (26) we can write this probability of error

DNR

in Fig. 11. The required DNR

for a given

can

in terms of the rate-normalized distortion-to-noise ratio

be compared to (50) to determine the gap to capacity. For ex-

DNR

DNR

ample, at an error probability of

, uncoded STDM is about

13.6 dB from capacity. One can reduce this gap by at least 9.3 dB

DNR

through channel coding, vector quantization, and nondithered

DNR

(49)

quantization. The remaining gap (at most 4.3 dB) is the gap be-

tween QIM and capacity and can be closed with distortion com-

A capacity-achieving method can achieve arbitrarily low prob-

pensation. As shown in [15], [27], it is fairly easily to close the ability of error as long as

, which using (38) can

gap between uncoded STDM (with uniform scalar quantizers)

be expressed as

and capacity by about 6 dB using practical channel codes and

distortion compensation.

DNR

3) Uncoded Spread LBM Gap to Capacity: The gap to ca-

pacity for uncoded binary spread LBM based on uniform, scalar





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1437

quantization also follows readily from the results of Appendix

a uniform distribution over the interval

. In this

A, which shows that the distortion-normalized minimum dis-

case

tance for this form of spread LBM is a factor of

2.43 dB

worse than that of STDM (26). Thus, the LBM counterpart to

(49) is that the bit-error probability of uncoded spread LBM is

where the quantization error

is uniformly distributed over the

interval

and statistically independent of

[29].

DNR

(51)

Thus, the achievable rate

is slightly lower than the

case where

is Gaussian. The entropy power inequality can be

Thus, the gap to capacity of uncoded binary spread LBM at an

used to show that the decrease in achievable rate is bounded by

error probability of

is about 16 dB, 2.4 dB more than the

[36]

13.6-dB gap of uncoded binary STDM. Furthermore, as also

discussed in Appendix A, for

-ary implementations the gap

DNR

(54)

widens by an additional 0.6 dB as

.

DNR

4) Coded Additive Spread-Spectrum Gap to Capacity: For

This gap approaches the upper limit of

0.2546

additive spread spectrum, where

, the distortion

b/dimension as the DNR gets large. For any finite DNR, the gap

signal in Fig. 2 is not a function of the host signal:

is smaller. By subtracting the upper bound on the gap (54) from

. Thus,

. The distortion constraint

the capacity (38), one obtains a lower bound on the achievable

is still

so that in the Gaussian case considered here,

rate of this type of dither modulation

the achievable rate of an additive spread-spectrum method is the

well-known [31] Gaussian channel capacity, treating both and

as interference sources20

DNR

(55)

DNR

Thus, dither modulation with uniform scalar quantization in this

SNR

case is at most

1.53 dB from capacity.

(52)

VIII. INTENTIONAL ATTACKS

where, again, SNR is the ratio between the host-signal variance

and the channel-noise variance. Comparing (52) to (38), we see

We now turn our attention from AWGN channel models for

that the gap to capacity of additive spread spectrum is

unintentional attacks, to some alternative models for intentional

attacks. Intentional, distortion-constrained attacks may be en-

DNR

countered in copyright, authentication, and covert communica-

SNR

(53)

DNR

tion applications. In these kinds of applications, attackers gen-

erally attempt to remove or alter the embedded information, and

which is typically large, since SNR

must be large so that

face a distortion constraint on their signal manipulations so that

channel noise will not excessively degrade signal quality.

the integrity of the host signal is not compromised.

In fact, in the high signal-to-distortion rastio (SDR) limit

An attacker's ability to prevent reliable watermark decoding

where

, the achievable rate of additive spread-spec-

depends on the amount of knowledge that the attacker has

trum (52) clearly approaches zero, again reflecting the inability

about the embedding and decoding processes. To limit such

of additive spread-spectrum methods to reject host-signal

knowledge, some digital watermarking systems use keys, pa-

interference like other methods.

rameters that allow appropriate parties to embed and/or decode

At the opposite extreme, when SNR

the host inter-

the embedded signal. The locations of the modulated bits

ference is small so the gap (53) disappears, and, indeed, addi-

and the pseudo-noise vectors in an additive spread-spectrum

tive spread spectrum is an optimum embedding strategy for this

and generalized LBM systems are examples of keys. If only

case, along with both DC-QIM and QIM as discussed at the end

certain parties privately share the keys to both embed and

of Section VII-A.

decode information, and no one else can do either of these

The other scenario in which additive spread spectrum can be

two functions, then the watermarking system is a private-key

optimal is when the host is known at the decoder, which also

system. Alternatively, if some parties possess keys that allow

corresponds to a noninterfering host situation.

them to either embed or decode, but not both, then the system

5) Known-Host Case: As discussed at the end of Sec-

is a public-key system since these keys can be made available

tion VII-A, both capacity-achieving QIM and capacity-achie-

to the public for use in one of these two functions without

ving additive spread-spectrum methods exist when the host

allowing the public to perform the other function. However, in

signal is known at the decoder. Although QIM realizations in

some scenarios it may be desirable to allow everyone to embed

the form of coded dither modulation with uniform, scalar quan-

and decode watermarks without the use of keys. For example,

tization are not optimal in this case, for AWGN channels one

in a copyright ownership notification system, everyone could

can achieve performance within

1.53 dB of capacity

embed the ASCII representation of a copyright notice such as,

as we show below. We consider the case of dither signals with

"Property of ..." in their copyrightable works. Such a system

20This rate is also the capacity when n is non-Gaussian, but still independent is analogous to the system currently used to place copyright

of s, and a correlation detector is used for decoding [35].

notices in (hardcopies of) books, a system in which there is no





1438

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

need for a central authority to store, register, or maintain sep-

capacity in this high-fidelity limit. The capacity-achieving dis-

arate keys-there are none-or watermarks-all watermarks

tortion-compensation parameter is [16]

are English messages-for each user. The widespread use of

DNR

such a universally accessible "no-key" system requires only

-

DNR

standardization of the decoder so that everyone will agree on

the decoded watermark, and hence, the owner of the copyright.

We analyze both private-key and no-key systems in the se-

B. Attacks on No-Key Systems

quel, and establish the attractiveness of QIM in both cases.

In contrast to the scenario above, in no-key systems an at-

tacker has full knowledge of the embedding and decoding pro-

A. Attacks on Private-Key Systems

cesses, including all codebooks. For this case, some determin-

Although the attacker does not know the key in a private-key

istic models we develop in this section are better for character-

scenario, he or she may know the basic algorithm used to embed

izing the associated worst case in-the-clear (i.e., fully informed) the watermark. In [16], Moulin and O'Sullivan model such a attacks. With these models, we show that QIM methods in gen-scenario by assuming that the attacker knows the codebook dis-

eral, and dither modulation in particular, are robust and achieve

tribution, but not the actual codebook. As we now develop, ex-

provably better rate distortion-robustness tradeoffs than both

ploiting results of Moulin and O'Sullivan in this private-key

additive spread-spectrum and generalized LBM techniques.

scenario, we determine that DC-QIM methods are optimal (ca-

We consider two models for such attackers: 1) a bounded

pacity-achieving) against squared-error distortion-constrained

perturbation channel model in which the squared-error distor-

attackers.

tion between the channel input and channel output is bounded

Moulin and O'Sullivan have derived both the capacity-

and 2) a bounded host-distortion channel model in which the

achieving distribution and an explicit expression for the ca-

squared-error distortion between the host signal and channel

pacity (32) in the case where the host is white and Gaussian and

output is bounded. In each case, we develop conditions under

the attacker faces an expected perturbation energy constraint

which error-free decoding is possible with various implementa-

. In this case, the capacity is [16]

tions of QIM and DC-QIM, and quantify their advantages over

the corresponding realizations of additive spread spectrum and

DNR

generalized LBM.

1) Bounded Perturbation Channel: The bounded perturba-

SNR

DNR

tion channel is one in which the attacker can perturb the com-

posite signal in any way it desires (based on its full knowledge

SNR

DNR

of the composite signal and the embedding algorithm), provided

where DNR

is the distortion-to-perturbation

the energy in the perturbation vector does not exceed a pre-

ratio and SNR

is the host-signal-to-perturba-

scribed level, i.e., (16), which reflects a requirement that the

tion ratio. The maximizing distribution is such that [16]

attacker not excessively degrade the original composite signal.

Thus, this channel model imposes only a maximum distortion21

or minimum SNR constraint between the channel input and

output.

with

statistically independent of

and

Binary dither modulation with uniform scalar quantiza-

DNR

tion: One can combine the guaranteed error-free decoding con-

(56)

dition (17) for a minimum-distance decoder (15) with the distor-

DNR

tion-normalized minimum distance (26) of binary dither modu-

Since this distribution satisfies the condition (33), we can infer

lation with uniform scalar quantization to compactly express its

from our analysis in Section VI-A2 that DC-QIM can be used

achievable performance as

to achieve capacity against these attacks. Moreover, (56) gives

the optimal distortion-compensation parameter.

(57)

Moulin and O'Sullivan have also considered the case of host

signals that are not necessarily Gaussian but that have zero

or, equivalently, its achievable rate as

mean, finite variance, as well as bounded and continuous pdfs.

In the limit of small

(high SDR) and

, a limit of interest

(58)

in high-fidelity applications, the capacity approaches

One can view the achievable rate (58) as the deterministic coun-

-

DNR

terpart to the more conventional notions of achievable rates and

capacities of random channels discussed in Sections VI and VII.

and the capacity-achieving distribution is such that

21Some types of distortion, such as geometric distortions, can be large in

-

terms of squared error, yet still be small perceptually. However, in some cases, these distortions can be mitigated either by preprocessing at the decoder or by where, again,

is statistically independent of

embedding information in parameters of the host signal that are less affected (in terms of squared error) by these distortions. For example, a simple delay or

[16]. Since this distribution satisfies the condition (33), we can shift may cause large squared error, but the magnitude of the discrete Fourier again conclude that distortion-compensated QIM can achieve

transform coefficients are relatively unaffected.





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1439

Additive spread spectrum: The nonzero minimum dis-

TABLE I

tance of QIM methods offers quantifiable robustness to per-

ATTACKER'S DISTORTION PENALTIES. THE DISTORTION PENALTY IS THE

ADDITIONAL DISTORTION THAT AN ATTACKER MUST INCUR TO SUCCESSFULLY

turbations, even when the host signal is not known at the

REMOVE A WATERMARK. A DISTORTION PENALTY LESS THAN 0 dB INDICATES

decoder. In contrast, additive spread-spectrum methods offer

THAT THE ATTACKER CAN ACTUALLY IMPROVE THE SIGNAL QUALITY AND

relatively little robustness if the host signal is not known at the REMOVE THE WATERMARK SIMULTANEOUSLY

decoder. As discussed in Section III, these methods have linear

embedding functions of the form

(59)

where

is a pseudo-noise vector. From the definition of

minimum distance (13)

i.e., the minimum distance is zero.

the expectation is taken with respect to

. The ratio between

Thus, although these methods may be effective when the

and the expected embedding-induced distortion

is the

host signal is known at the decoder, when the host signal is not

distortion penalty that the attacker must pay to remove the wa-

known, they offer no guaranteed robustness to perturbations,

termark and, hence, is a figure of merit measuring the robust-

i.e., no achievable rate expression analogous to (58) exists for

ness-distortion tradeoff at a given rate. Distortion penalties for

additive spread spectrum. As is evident from (59), in an additive

the primary methods of interest are derived below and summa-

spread-spectrum system,

is an additive interference, which

rized in Table I for the high SDR regime of primary interest.

is often much larger than

due to the distortion constraint.

As this table reflects, among these methods considered, only

In contrast, the quantization that occurs with QIM provides

QIM methods (including binary dither modulation with uniform

immunity against this host-signal interference, as discussed in

scalar quantization) are robust enough such that the attacker

Section IV.22

must degrade the host-signal quality to remove the watermark.

Generalized LBM: As shown in Appendix A, the distor-

Regular QIM: We first consider the robustness of regular

tion-normalized minimum distance of generalized binary LBM

QIM. For any distortion measure, as long as each reconstruc-

with uniform scalar quantization is about 2.43 dB worse than

tion point lies at the minimum-distortion point of its respective

that of the corresponding dither-modulation strategy. Therefore,

quantization cell, the QIM distortion penalty is greater than or

its achievable rate-distortion-robustness performance is also

equal to since any output

that an attacker generates must nec-

about 2.43 dB worse than (57). Again, as also developed in the

essarily lie away from this minimum-distortion point. Equality

appendix, for

-ary implementations, the gap grows to 3 dB

occurs only if each quantization cell has at least two minimum-

for large

.

distortion points, one of which lies in the incorrect decoder de-

2) Bounded Host-Distortion Channel: As an alternative to

cision region. For expected squared-error distortion, the min-

the bounded perturbation channel, some attackers may work

imum-distortion point of each quantization cell is its centroid,

with distortion constraint between the channel output and the

and one can express this distortion penalty in terms of the dis-

host signal, rather than the channel input, since this distortion

tortion-normalized minimum distance and the signal length

,

is the most direct measure of degradation to the host signal. For

as we show below.

example, if attackers have partial knowledge of the host signal,

We use

to denote the quantization cell containing

and

which may be in the form of a probability distribution, so that

to denote the conditional pdf of

given that

.

they can calculate this distortion, then it may be appropriate to

Again, for sufficiently small quantization cells, this pdf can

bound the expected distortion

, where this ex-

often be approximated as uniform over

, for example. Since

pectation is taken over the conditional probability density

.23

is the centroid of

We refer to this as the bounded host-distortion channel.

For this channel, we measure robustness to attacks by the

(60)

minimum expected distortion

for a successful attack, where

22Another way to understand this host-signal interference rejection is to consider, for example, that a quantized random variable has finite entropy while a Also, the expected squared error per letter embedding-induced

continuous random variable has infinite entropy.

distortion given

is

23Note that if the attacker has full knowledge of the host signal, he or she can trivially remove the embedded information by setting

= , so D = 0. We

restrict our attention to the more realistic scenario in which an attacker has only (61)

partial knowledge of the host, in the form of a conditional pdf.





1440

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

The most general attack can always be represented as

an expression whose counterpart for the bounded perturbation

, where

may be a function of . The resulting distortion

channel was (57). Thus, the corresponding achievable rates are

is

given by

Distortion-compensated QIM: An in-the-clear attacker of

a DC-QIM system knows the quantizers and can determine the

watermark

after observing the composite signal . If the quan-

tization cells are contiguous so that the distortion-compensation

term in (19) does not move out of the cell containing , then an

attacker can recover the original host signal with the following

attack:

where we have used (61), the fact that

is a pdf and, thus,

integrates to one, and (60) to obtain the last line. For a successful attack,

so

where the final line follows simply by inverting (19). Thus, the

Averaging both sides of this expression over all quantization

attacker's distortion penalty

is

decibels. We see

cells

yields

so that our figure of merit

that although DC-QIM is optimal against both independent ad-

for QIM methods is

ditive Gaussian noise attacks and squared-error-distortion-con-

strained attacks in private-key scenarios, it is in some sense

(62)

"maximally suboptimal" against in-the-clear attacks. Regular

QIM, on the other hand, is almost as good as DC-QIM against

Thus, for any QIM method of nonzero distortion-normalized

additive Gaussian noise attacks (Section VII) and also resistant

minimum distance

, the attacker's distortion penalty is al-

to in-the-clear attacks as discussed above. Thus, regular QIM

ways greater than

(0 dB), indicating that to remove the water-

methods may offer an attractive compromise when one requires

mark, the attacker must degrade the host-signal quality beyond

resistance to both intentional attacks and unintentional attacks

the initial distortion caused by the embedding of the watermark.

in a no-key system.

Binary dither modulation with uniform, scalar quantiza-

Additive spread spectrum: Since the embedding function

tion: In this case, (26) gives

in (62). Moreover, due to the

of an additive spread-spectrum system is (2), the resulting dis-

uniformity of the quantizers, the bound (62) is met with equality

tortion is

. An attacker with full knowledge

so that the attacker's distortion penalty specializes to

of the embedding and decoding processes can decode the mes-

sage

, and hence, reproduce the corresponding pseudo-noise

(63)

vector

. Therefore, the attacker can completely remove the

Because the Hamming distance

of a block code cannot ex-

watermark by subtracting

from

to obtain the original host

ceed the number of coded bits

signal, i.e.,

. Hence, the resulting distortion

penalty is

decibels.

Because the additive spread-spectrum embedding function

combines the host signal

and watermark

in a simple

where the first equality follows from the definition (23) of

.

linear way, anyone that can extract the watermark, can easily re-

Thus, an upper bound for the distortion penalty (63) in this case

move it. Thus, these methods are not suitable for universally ac-

is

cessible no-key digital watermarking applications. By contrast,

the advantage of QIM is that it effectively hides the host signal

2.43 dB

even when the embedded information

is known.

Generalized LBM: Recall that the embedding function of

Although this penalty may seem modest, it is larger than that ob-

a generalized LBM system can be written as (8) with

having

tainable by either additive spread spectrum or generalized LBM,

the property (9). Good generalized LBM systems also have the

as we show below. Larger distortion penalties are not possible

property that the reconstruction points of

are at the cen-

because in-the-clear attackers can concentrate all their distortion troids of the quantization cells, as we shall assume. One attack

in the minimum-distance direction in

-dimensional space.

that completely removes information about

is to output these

As a final note, (63) implies that binary dither modulation

reconstruction points, i.e.,

. Since

is at a

with uniform, scalar quantization can defeat any attacker as long

minimum distortion point of the quantization cell,

as

0 dB, with equality only if both

and

are minimum

distortion points. Thus, an attacker can remove the watermark

without causing additional distortion to the host signal. This





CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1441

result applies regardless of whether error-correction coding is

DC-QIM is as efficient as any single digital transmission, and

used. Thus, in contrast to dither modulation, error-correction

thus as good as the alternative superposition coding and succes-

coding does not improve LBM in this context.

sive cancellation-decoding approach.

When, in addition, it is the least significant bit of a uniform,

Many important directions for further research remain. At

scalar quantizer that is modulated, the results in Appendix A

one end of the spectrum, further insights into the fundamental

imply further that

principles and structure of information embedding and digital

watermarking systems will come from the development of still

better general attack models. Those emerging from game-theo-

retic formulations and arbitrarily varying channel models appear

while

to be an important starting point in this respect.

At the same time, many of the results in this paper have im-

portant implications for practical applications, and the most ef-

fective implementations of QIM and DC-QIM embedding sys-

Thus,

2.43 dB. Again, when many less

tems for these applications will take into account, in detail, the

significant bits are modulated, the results of the appendix can

specific types of geometric distortions and other attacks that typ-

be used to establish that the penalty grows to

3 dB.

ically arise. For example, in image watermarking applications,

embedders and decoders ultimately need to be robust to a wide

IX. CONCLUDING REMARKS

range of often surprisingly challenging attacks, ranging from

We have seen that QIM methods are provably better than ad-

scaling and rotation, to cropping and column replacement. A

ditive spread spectrum and generalized LBM against bounded

great deal of future work is needed in this area to enable the use

perturbation and in-the-clear attacks and are near-optimal for

of QIM techniques in watermarking applications, and indeed

Gaussian channels, for which DC-QIM is optimal. Furthermore,

these represent some especially interesting design challenges.

dither modulation is a practical implementation of QIM that

exhibits many of the attractive performance properties of QIM.

APPENDIX A

The convenient structure of dither modulation, which is easily

LBM DISTORTION-NORMALIZED MINIMUM DISTANCE

combined with error-correction coding, allows the system de-

In this appendix we calculate the distortion-normalized min-

signer to achieve different rate distortion-robustness tradeoffs

imum distance of binary LBM with uniform, scalar quantiza-

by tuning parameters such as the quantization step size. Also,

tion. We assume that the host signal and embedded signal are

one can conveniently upgrade previously developed additive

statistically independent.

spread-spectrum and spread LBM systems to spread-transform

Since the embedding function of any good generalized LBM

dither-modulation systems by replacing the respective addition

method can be written as (8) with (10), the expected distortion

and quantize-and-replace steps with a dithered quantization

is

step.

In the course of our investigation, a number of rather

intriguing results have emerged. For example, the informa-

tion-embedding capacity in the Gaussian case does not depend

at all on whether the host signal is available during decoding,

and DC-QIM is optimal in both scenarios, and achieves perfect

rejection of host-signal interference, even in the high-SDR

regime.

Also somewhat surprisingly, the optimal embedding strategy

(64)

for Gaussian channels and for typical attacks in private-key sys-

tems, DC-QIM is "maximally suboptimal" against in-the-clear

where we have used (10) and the independence of

and

to

attacks. On the other hand, regular QIM, which has performance

obtain the final line.

within 4.3 dB of DC-QIM in the Gaussian case, performs better

We analyze coded binary LBM with uniform scalar quantiza-

than any other currently known method against in-the-clear at-

tion, an LBM system in which each in a sequence of coded bits

tacks, which arise in copyright notification applications where

is repeated

times and embedded in a length-

block with a

no-key architectures are used, for example. In particular, unlike

sequence of uniform, scalar quantizers.

additive spread-spectrum and generalized LBM methods, QIM

The embedding is accomplished by modulating the least sig-

and dither-modulation methods force an attacker to pay a dis-

nificant bit of each quantizer. The th uniform, scalar quantizer

tortion penalty. Thus, QIM emerges as a universally good em-

is illustrated in Fig. 12. The coarse quantizer

has a step

bedding strategy against a wide variety of intentional and unin-

size of

, and the th least significant bit adjustment element

tentional attacks.

equals

.

For hybrid transmission strategies, using DC-QIM for digital-

Comparing this scheme to coded binary dither modulation

over-analog transmission (in, for example, digital audio broad-

with uniform scalar quantization as described in Section V-A,

casting applications) allows embedding rates of about 1/3 b/s/Hz

we see that this scheme has the same minimum distance, i.e.,

for every decibel drop in analog signal quality. In digital-over-

(22). Restricting attention to the high SDR regime in which

digital transmission (in broadcast applications, for example),

can be modeled as uniformly distributed within each cell of

,





1442

IEEE TRANSACTION ON INFORMATION THEORY, VOL. 47, NO. 4, MAY 2001

ACKNOWLEDGMENT

The authors thank Prof. A. Lapidoth for calling their attention

to the paper by Costa, and an anonymous reviewer for helpful

comments that improved the clarity of the paper.

REFERENCES

[1] M. D. Swanson, M. Kobayashi, and A. H. Tewfik, "Multimedia data-embedding and watermarking technologies," Proc. IEEE, vol. 86, pp.

Fig. 12.

Low-bit modulation with a uniform, scalar quantizer. The quantizer

1064-1087, June 1998.

has a step size of 1 =2, and the least significant bit (lsb) is modulated. All

[2] I. J. Cox and J.-P. M. G. Linnartz, "Some general methods for tampering reconstruction points marked with a 2 have an lsb of 0. Points marked with a with watermarks," IEEE J. Select. Areas Commun. , vol. 16, pp. 587-593, have an lsb of 1. This process is equivalent to first quantizing using a quantizer May 1998.

with a step size of 1 , whose reconstruction points are marked with a , and

[3] J.-P. Linnartz, T. Kalker, and J. Haitsma, "Detecting electronic water-adding 61 =4.

marks in digital video," in Proc. 1999 IEEE Int. Conf. Acoustics, Speech, and Signal Processing, vol. 4, Phoenix, AZ, Mar. 1999, pp. 2071-2074.

as was used to develop (24) in Section V-A, the first term in (64)

[4] G. Arce, C. G. Boncelet Jr., R. F. Graveman, and L. M. Marvel, "Applications of information hiding," in Proc. 3rd Annu. Federated Labora-is

tory Symp. Advanced Telecommunications & Information Distribution Research Program, College Park, MD, Feb. 1999, pp. 423-427.

(65)

[5] H. C. Papadopoulos and C.-E. W. Sundberg, "Simultaneous broad-

casting of analog FM and digital audio signals by means of adaptive precanceling techniques," IEEE Trans. Commun. , vol. 46, pp.

1233-1242, Sept. 1998.

the same as the expected distortion (25) of the corresponding

[6] B. Chen and C.-E. W. Sundberg, "Broadcasting data in the FM band dither modulation system. The second term in (64), however, is

by means of adaptive contiguous band insertion and precancelling techniques," in Proc. 1999 IEEE Int. Conf. Communications, vol. 2, Van-couver, BC, Canada, June 1999, pp. 823-827.

(66)

[7] M. D. Swanson, B. Zhu, and A. H. Tewfik, "Data hiding for video-in-video," in Proc. 1997 IEEE Int. Conf. Image Processing, vol. 2, Piscat-away, NJ, 1997, pp. 676-679.

Thus, the overall expected distortion is

[8] J. M. Barton, "Method and apparatus for embedding authentication information within digital data," United States Patent 5 646 997, July 1997.

[9] K. Tanaka, Y. Nakamura, and K. Matsui, "Embedding secret information into a dithered multi-level image," in Proc. 1990 IEEE Military Communications Conf. , 1990, pp. 216-220.

and the distortion-normalized squared minimum distance is

[10] W. Bender, D. Gruhl, N. Morimoto, and A. Lu, "Techniques for data hiding," IBM Syst. J. , vol. 35, no. 3-4, pp. 313-336, 1996.

[11] I. J. Cox, J. Killian, T. Leighton, and T. Shamoon, "A secure, robust watermark for multimedia," in Information Hiding. 1st Int. Workshop Proc. , June 1996, pp. 185-206.

By comparing with (26), we see that binary coded LBM with

[12] J. R. Smith and B. O. Comiskey, "Modulation and information hiding in images," in Information Hiding. 1st Int. Workshop Proc. , June 1996, pp.

uniform scalar quantization is worse than the corresponding

207-226.

dither modulation system by

[13] J. R. Hernandez, F. Perez-Gonzalez, J. M. Rodriguez, and G. Nieto, "Performance analysis of a 2-D-multipulse amplitude modulation scheme

for data hiding and watermarking of still images," IEEE J. Select. Areas 2.43 dB

(67)

Commun. , pp. 510-524, May 1998.

[14] J. A. O'Sullivan, P. Moulin, and J. M. Ettinger, "Information theoretic analysis of steganography," in Proc. 1998 IEEE Int. Symp. Information Also, note that the result (67) is invariant to the actual dis-Theory, Cambridge, MA, Aug. 1998, p. 297.

tribution of the

's, and invariant to any preprocessing of the

[15] B. Chen and G. W. Wornell, "Implementations of quantization index host signal by a unitary transformation. Thus, the gap between

modulation methods for digital watermarking and information embed-

ding of multimedia," J. VLSI Signal Processing Syst. Signal, Image, and STDM and spread LBM is also given by (67).

Video Technol. (Special Issue on Multimedia Signal Processing), vol. 27, In other variants of LBM, the gap can be worse. For in-pp. 7-33, Feb. 2001.

stance, in the case of

-ary coded implementations of dither

[16] P. Moulin and J. A. O'Sullivan, "Information-theoretic analysis of information hiding," preprint, Oct. 1999.

modulation and LBM based on uniform scalar quantization

[17] N. Merhav, "On random coding error exponents of watermarking sys-where the

sets of reconstruction points together form a

tems," IEEE Trans. Inform. Theory, vol. 46, pp. 420-430, Mar. 2000.

regular lattice, then the minimum distances of the two schemes

[18] A. Cohen and A. Lapidoth, "On the Gaussian watermarking game," in Proc. IEEE Int. Symp. Information Theory, Sorrento, Italy, June 2000, remain equal (but generally different from the binary case), and

p. 48.

the first term in (64) remains (65). However, as

gets large,

[19] P. Moulin and J. O'Sullivan, "Information-theoretic analysis of informa-becomes effectively uniformly distributed over the range

tion hiding," in Proc. IEEE Int. Symp. Inform. Theory, Sorrento, Italy, June 2000, p. 19.

, so the second term in (64) changes from (66) to

[20] R. J. Barron, B. Chen, and G. W. Wornell, "The duality between information embedding and source coding with side information and some

applications," IEEE Trans. Inform. Theory, submitted for publication.

[21] I. J. Cox, M. L. Miller, and A. L. McKellips, "Watermarking as communications with side information," Proc. IEEE, vol. 87, pp. 1127-1141, July 1999.

the same as (65). Thus, the gap (67) grows to a factor of

(3

[22] F. Hartung and M. Kutter, "Multimedia watermarking techniques," Proc.

dB) in this large

limit.

IEEE, vol. 87, pp. 1079-1107, July 1999.

CHEN AND WORNELL: QUANTIZATION INDEX MODULATION

1443

[23] F. A. P. Petitcolas, R. J. Anderson, and M. G. Kuhn, "Information

[30] R. Zamir and M. Feder, "On lattice quantization noise," IEEE Trans.

hiding-A survey," Proc. IEEE, vol. 87, pp. 1062-1078, July 1999.

Inform. Theory, vol. 42, pp. 1152-1159, July 1996.

[24] A. Z. Tirkel, G. A. Rankin, R. van Schyndel, W. J. Ho, N. R. A. Mee,

[31] T. M. Cover and J. A. Thomas, Elements of Information Theory.

New

and C. F. Osborne, "Electronic water mark," in Proc. Conf. Digital Image York: Wiley, 1991.

Computing, Technology and Applications, Sydney, Australia, Dec. 1993,

[32] S. I. Gel'fand and M. S. Pinsker, "Coding for channel with random pa-pp. 666-672.

rameters," Probl. Contr. Inform. Theory, vol. 9, no. 1, pp. 19-31, 1980.

[25] R. van Schyndel, A. Z. Tirkel, and C. F. Osborne, "A digital watermark,"

[33] C. Heegard and A. A. E. Gamal, "On the capacity of computer memory in Proc. 1st IEEE Int. Conf. Image Processing, vol. 2, Austin, TX, Nov.

with defects," IEEE Trans. Inform. Theory, vol. IT-29, pp. 731-739, 1994, pp. 86-90.

Sept. 1983.

[26] I. J. Cox, J. Killian, F. T. Leighton, and T. Shamoon, "Secure spread spec-

[34] M. H. M. Costa, "Writing on dirty paper," IEEE Trans. Inform. Theory, trum watermarking for multimedia," IEEE Trans. Image Processing, vol.

vol. IT-29, pp. 439-441, May 1983.

6, pp. 1673-1687, Dec. 1997.

[35] A. Lapidoth, "Nearest neighbor decoding for additive non-Gaussian

[27] B. Chen, "Design and analysis of digital watermarking, information em-noise channels," IEEE Trans. Inform. Theory, vol. 42, pp. 1520-1529, bedding, and data hiding systems," Ph.D. dissertation, MIT, Cambridge, Sept. 1996.

MA, June 2000.

[36] F.-W. Sun and H. C. A. van Tilborg, "Approaching capacity by equiprob-

[28] E. A. Lee and D. G. Messerschmitt, Digital Communication, 2nd able signaling on the Gaussian channel," IEEE Trans. Inform. Theory, ed.

Boston, MA: Kluwer Academic, 1994.

vol. 39, pp. 1714-1716, Sept. 1993.

[29] N. S. Jayant and P. Noll, Digital Coding of Waveforms: Principles and Applications to Speech and Video.

Englewood Cliffs, NJ: Prentice-

Hall, 1984.





